<html>
    <title> Project for AD Calculations </title>
    <head>
        <link type="text/css" rel = "stylesheet" href = "stylesheet_v4.css">
    </head>
    <div id = "divLeft">
         
        <form id = "form_1" action = "" method = "" onSubmit="return false" display = "inline">
            <p>
                <table>
                    <colgroup>
                        <col span="1" class="input_label">
                        <col span="1" class="input_text">
                        <col span="1" class="other_unit">
                    </colgroup>

                <tr>
                    <td colspan ="3" style="text-align:center" > <h2>CAS to EAS, TAS & Mach</h2></td>    
                </tr>    
                <tr>
                    <td><input type="radio" name="yesorno" id="f1_Ruski" checked="checked" onclick="f1_ac_selector();f1_calc1()" > Rus &emsp; &emsp; &emsp;  </td>
                    <td><input type="radio" name="yesorno" id="f1_West" onclick="f1_ac_selector();f1_calc1()" > West  </td></br></br>
                </tr>

                <tr>
                    <td><label for="f1_cas_l">CAS:</label></td>
                    <td><input type="text" id="f1_cas" placeholder="KMPH" onkeyup="f1_calc1();" autofocus="autofocus" name=""> </br> </br></td>
                    <td><label id="f1_cas_other_unit">  </label> </td>
                </tr>

                <tr>
                    <td><label for="f1_altitude_l">Altitude:</label></td>
                    <td><input type="text" id="f1_altitude" placeholder="KM" onkeyup="f1_calc1();" name=""> </br> </br></td>
                    <td><label id="f1_alt_other_unit">  </label></td>
                </tr>

                <tr>
                    <td><label for="f1_isa_delta_l">ISA+T (C):</label></td>
                    <td><input type="text" id="f1_isa_delta" placeholder="C" onkeyup="f1_calc1();" name=""> </br> </br></td>
                    
                </tr>

                <tr>
                    <td><label id="f1_eas_l">EAS:</label></td>
                    <td><input type="text" readonly id="f1_eas"  name="eas"> </br> </br></td>
                    <td><label id="f1_eas_other_unit">  </label></td>
                </tr>

                <tr>
                    <td><label id="f1_tas_l">TAS:</label></td>
                    <td><input type="text" readonly id="f1_tas"  name="tas"> </br> </br></td>
                    <td><label id="f1_tas_other_unit">  </label></td>
                </tr>

                <tr>
                    <td><label id="f1_mach_label">MACH:</label></td>
                    <td><input type="text" readonly id="f1_mach"  name="mach"> </br> </br></td>
                     
                </tr>

                </table>

            </p>
        
            <label id="f1_status_1"> </label> </br></br>
            <label id="f1_status_2"> </label>

        </form>
    </div>
    
    <div id = "divLeft">
         
        <form id = "form_2" action = "" method = "" onSubmit="return false" display = "inline">
            <p>
                <table>
                    <colgroup>
                        <col span="1" class="input_label">
                        <col span="1" class="input_text">
                        <col span="1" class="other_unit">
                    </colgroup>

                <tr>
                    <td colspan ="3" style="text-align:center" > <h2>Mach to TAS, EAS & CAS </h2></td>    
                </tr>    
                <tr>
                    <td><input type="radio" name="yesorno" id="f2_Ruski" checked="checked" onclick="f2_ac_selector();f2_calc2()" > Rus &emsp; &emsp; &emsp;  </td>
                    <td><input type="radio" name="yesorno" id="f2_West" onclick="f2_ac_selector();f2_calc2()" > West  </td></br></br>
                </tr>

                <tr>
                    <td><label for="f2_mach">M:</label></td>
                    <td><input type="text" id="f2_mach" placeholder="" onkeyup="f2_calc2();" autofocus="autofocus" name=""> </br> </br></td>
                </tr>

                <tr>
                    <td><label for="f2_altitude">Altitude:</label></td>
                    <td><input type="text" id="f2_altitude" placeholder="KM" onkeyup="f2_calc2()" name=""> </br> </br></td>
                    <td><label id="f2_alt_other_unit">  </label></td>
                </tr>

                <tr>
                    <td><label id="f2_tas_l">TAS:</label></td>
                    <td><input type="text" readonly id="f2_tas"  name="tas"> </br> </br></td>
                    <td><label id="f2_tas_other_unit">  </label></td>
                </tr>

                <tr>
                    <td><label id="f2_eas_l">EAS:</label></td>
                    <td><input type="text" readonly id="f2_eas"  name="eas"> </br> </br></td>
                    <td><label id="f2_eas_other_unit">  </label></td>
                </tr>

                <tr>
                    <td><label id="f2_cas_l">CAS:</label></td>
                    <td><input type="text" readonly id="f2_cas"  name="cas2"> </br> </br></td>
                    <td><label id="f2_cas_other_unit">  </label></td>
                     
                </tr>



                </table>

            </p>
        </br>
        </br>
            <label id="f2_status_1"> </label> </br></br>
            <label id="f2_status_2"> </label>

        </form>
    </div>

    <div id = "divLeft">
         
        <form id = "form_3" action = "" method = "" onSubmit="return false" display = "inline">
            <p>
                <table>
                    <colgroup>
                        <col span="1" class="input_label">
                        <col span="1" class="input_text">
                        <col span="1" class="other_unit">
                    </colgroup>

                <tr>
                    <td colspan ="3" style="text-align:center" > <h2>TAS to CAS & MACH </h2></td>    
                </tr>    
                <tr>
                    <td><input type="radio" name="yesorno" id="f3_Ruski" checked="checked" onclick="f3_ac_selector();f3_calc3()" > Rus &emsp; &emsp; &emsp;  </td>
                    <td><input type="radio" name="yesorno" id="f3_West" onclick="f3_ac_selector();f3_calc3()" > West  </td></br></br>
                </tr>
                
                <tr>
                    <td><label for="f3_tas_l">TAS:</label></td>
                    <td><input type="text" id="f3_tas" placeholder="" onkeyup="f3_calc3();" autofocus="autofocus" name=""> </br> </br></td>
                    <td><label id="f3_tas_other_unit">  </label></td>
                </tr>

                <tr>
                    <td><label for="f3_altitude_l">Altitude:</label></td>
                    <td><input type="text" id="f3_altitude" placeholder="KM" onkeyup="f3_calc3()" name=""> </br> </br></td>
                    <td><label id="f3_alt_other_unit">  </label></td>
                </tr>

                <tr>
                    <td><label id="f3_m_l">M:</label></td>
                    <td><input type="text" readonly id="f3_m"  name="m"> </br> </br></td>
                </tr>

                <tr>
                    <td><label id="f3_eas_l">EAS:</label></td>
                    <td><input type="text" readonly id="f3_eas"  name="eas3"> </br> </br></td>
                    <td><label id="f3_eas_other_unit">  </label></td>    
                </tr>

                <tr>
                    <td><label id="f3_cas_l">CAS:</label></td>
                    <td><input type="text" readonly id="f3_cas"  name="cas3"> </br> </br></td>
                    <td><label id="f3_cas_other_unit">  </label></td>    
                </tr>

                </table>

            </p>
        
            <label id="f3_status_1"> </label> </br></br>
            <label id="f3_status_2"> </label>

        </form>
    </div>

    <div id = "divLeft">
         
        <form id = "form_4" action = "" method = "" onSubmit="return false" display = "inline">
            <p>
                <table>
                    <colgroup>
                        <col span="1" class="input_label">
                        <col span="1" class="input_text">
                        <col span="1" class="other_unit">
                    </colgroup>

                <tr>
                    <td colspan ="3" style="text-align:center" > <h2>CROSS OVER ALTITUDE </h2></td>    
                </tr>    
                <tr>
                    <td><input type="radio" name="yesorno" id="f4_Ruski" checked="checked" onclick="f4_ac_selector();f4_calc4()" > Rus &emsp; &emsp; &emsp;  </td>
                    <td><input type="radio" name="yesorno" id="f4_West" onclick="f4_ac_selector();f4_calc4()" > West  </td></br></br>
                </tr>
                
                <tr>
                    <td><label for="f4_cas_l">CAS:</label></td>
                    <td><input type="text" id="f4_cas" placeholder="kmph" onkeyup="f4_calc4();" autofocus="autofocus" name=""> </br> </br></td>
                    <td><label id="f4_cas_other_unit">  </label></td>
                </tr>

                <tr>
                    <td><label for="f4_m_l">M:</label></td>
                    <td><input type="text" id="f4_m" placeholder="" onkeyup="f4_calc4()" name=""> </br> </br></td>
                </tr>

                <tr>
                    <td><label id="f4_alt_l">Cross Over Alt:</label></td>
                    <td><input type="text" readonly id="f4_alt"  name=""> </br> </br></td>
                    <td><label id="f4_alt_other_unit">  </label></td>    
                </tr>

                </table>

            </p>
        
            <label id="f4_status_1"> </label> </br></br>
            <label id="f4_status_2"> </label>

        </form>
    </div>
    <script type="text/javascript">

        var f1_sys = 1; 
        var f2_sys = 1;
        var f3_sys = 1;
        var f4_sys = 1;

            // 1 - russian speed in kmph, altitude in km 
            // 2 - western speed in kt, altitude in ft

        function f1_ac_selector(){

            if (document.getElementById('f1_Ruski').checked)
            {
                document.getElementById("f1_cas").placeholder = "KMPH";
                document.getElementById("f1_altitude").placeholder = "KM";
                document.getElementById("f1_isa_delta").placeholder = "C";
                f1_sys =1;
                console.log("Ruski is selected");
            }
            if (document.getElementById('f1_West').checked)
            {
                document.getElementById("f1_cas").placeholder = "kt";
                document.getElementById("f1_altitude").placeholder = "ft";
                document.getElementById("f1_isa_delta").placeholder = "C";
                f1_sys =2;
                console.log("West is selected");
            }
        }

        function f1_calc1(){
            var f1_alt = document.getElementById("f1_altitude").value;
            var f1_t_delta = document.getElementById("f1_isa_delta").value;
            var f1_cas = document.getElementById("f1_cas").value;
            
        
            if (f1_sys ==1)   
            {   
                console.log("CAS:"+f1_cas);

                f1_temp_alt = fn_temp_alt(f1_alt,f1_t_delta);                   console.log("Temp:"+f1_temp_alt);
                f1_pres_alt = fn_pres_alt(f1_alt);                              console.log("Press:"+f1_pres_alt);
                f1_den_alt = fn_den_alt(f1_pres_alt,f1_temp_alt);               console.log("Density:"+f1_den_alt);

                f1_theta_alt = f1_temp_alt/288.15;                              console.log("Theta:"+f1_theta_alt);
                f1_sigma_alt = f1_den_alt/1.2250;                               console.log("Sigma:"+f1_sigma_alt);
                f1_delta_alt = f1_pres_alt / 101325;                              console.log("Delta:"+f1_delta_alt);

                f1_eas_alt = fn_ve_from_vc(f1_cas,f1_pres_alt);                 console.log("EAS:"+f1_eas_alt);
                f1_tas_alt = f1_eas_alt/Math.sqrt(f1_sigma_alt);                console.log("TAS:"+f1_tas_alt);
                f1_sos_alt = fn_sos_temp(f1_temp_alt);                          console.log("SOS:"+f1_sos_alt);

                f1_mach_alt = f1_tas_alt/fn_metpersec_kmph(f1_sos_alt);         console.log("Mach:"+f1_mach_alt);

                document.getElementById("f1_alt_other_unit").innerHTML = "&emsp;" + "("+fn_km_ft(f1_alt).toFixed(0) +"&emsp;ft)";
                document.getElementById("f1_cas_other_unit").innerHTML = "&emsp;" + "("+fn_kmph_kt(f1_cas).toFixed(1) +"&emsp;kt)";
                document.getElementById("f1_eas_other_unit").innerHTML = "&emsp;" + "("+fn_kmph_kt(f1_eas_alt).toFixed(1) +"&emsp;kt)";
                document.getElementById("f1_tas_other_unit").innerHTML = "&emsp;" + "("+fn_kmph_kt(f1_tas_alt).toFixed(1) +"&emsp;kt)";

                document.getElementById("f1_status_1").innerHTML = "T:" + Math.sign(f1_temp_alt-273.15) * (Math.abs(f1_temp_alt-273.15)).toFixed(1)+"&deg;C,"+"&emsp;P:"+(f1_pres_alt).toFixed(0)+"N/m&sup2,"+"&emsp;Den:"+(f1_den_alt).toFixed(3)+"kg/m&sup3;,";
                document.getElementById("f1_status_2").innerHTML = "&#963:" + (f1_sigma_alt).toFixed(3) + ",&emsp; &delta;: "+ (f1_delta_alt).toFixed(1)+ ",&emsp; &theta;: "+ (f1_theta_alt).toFixed(3)+ ",&emsp;a:"+(f1_sos_alt).toFixed(1)+"m/s"; 
            }
            else 
            { 
                console.log("CAS:"+f1_cas+"kt");

                f1_temp_alt = fn_temp_alt(fn_ft_km(f1_alt),f1_t_delta);             console.log("Temp:"+f1_temp_alt);
                f1_pres_alt = fn_pres_alt(fn_ft_km(f1_alt));                        console.log("Press:"+f1_pres_alt);
                f1_den_alt = fn_den_alt(f1_pres_alt,f1_temp_alt);                   console.log("Den:"+f1_den_alt);

                f1_theta_alt = f1_temp_alt/288.15;                                  console.log("Theta:"+f1_theta_alt);
                f1_sigma_alt = f1_den_alt/1.2250;                                   console.log("Sigma:"+f1_sigma_alt);
                f1_delta_alt = f1_pres_alt / 101325;                                  console.log("Rho:"+f1_delta_alt);
                
                f1_eas_alt = fn_ve_from_vc(fn_kt_kmph(f1_cas),f1_pres_alt);         console.log("EAS:"+f1_eas_alt);
                f1_tas_alt = f1_eas_alt/Math.sqrt(f1_sigma_alt);                    console.log("TAS:"+f1_tas_alt);
                f1_sos_alt = fn_sos_temp(f1_temp_alt);                              console.log("SOS:"+f1_sos_alt);

                f1_mach_alt = f1_tas_alt/fn_metpersec_kmph(f1_sos_alt);             console.log("Mach:"+f1_mach_alt);

                document.getElementById("f1_alt_other_unit").innerHTML = "&emsp;" + "("+fn_ft_km(f1_alt).toFixed(2) +"&emsp;km)";
                document.getElementById("f1_cas_other_unit").innerHTML = "&emsp;" + "("+fn_kt_kmph(f1_cas).toFixed(1) +"&emsp;kmph)";
                
                document.getElementById("f1_eas_other_unit").innerHTML = "&emsp;" + "("+f1_eas_alt.toFixed(1) +"&emsp;kmph)";
                document.getElementById("f1_tas_other_unit").innerHTML = "&emsp;" + "("+f1_tas_alt.toFixed(1) +"&emsp;kmph)";

                document.getElementById("f1_status_1").innerHTML = "T:" + Math.sign(f1_temp_alt-273.15) * (Math.abs(f1_temp_alt-273.15)).toFixed(1)+"&deg;C,"+"&emsp;P:"+(f1_pres_alt).toFixed(0)+"N/m&sup2,"+"&emsp;Den:"+(f1_den_alt).toFixed(3)+"kg/m&sup3;,";
                document.getElementById("f1_status_2").innerHTML = "&#963:" + (f1_sigma_alt).toFixed(3) + ",&emsp; &delta;: "+ (f1_delta_alt).toFixed(1)+ ",&emsp; &theta;: "+ (f1_theta_alt).toFixed(3)+ ",&emsp;a:"+(f1_sos_alt).toFixed(1)+"m/s"; 

                f1_eas_alt = fn_kmph_kt(f1_eas_alt).toFixed(1)
                f1_tas_alt = fn_kmph_kt(f1_tas_alt).toFixed(1)

            }

            if(!isNaN(f1_tas_alt)) 
            { 
                document.getElementById("f1_eas").value =   f1_eas_alt;
                document.getElementById("f1_tas").value =   f1_tas_alt;
                document.getElementById("f1_mach").value =  f1_mach_alt;   
            }

        }

        function f2_ac_selector(){
            console.log("iam in ac selector");
            if (document.getElementById('f2_Ruski').checked)
            {
                
                document.getElementById("f2_altitude").placeholder = "KM";
                f2_sys =1;
                console.log("Ruski is selected");
            }
            if (document.getElementById('f2_West').checked)
            {
        
                document.getElementById("f2_altitude").placeholder = "ft";
                f2_sys =2;
                console.log("West is selected");
            }
        }

        function f2_calc2()
        {

            var f2_m_alt = document.getElementById("f2_mach").value; 
            console.log("Mach: "+f2_m_alt);
            var f2_alt = document.getElementById("f2_altitude").value; 
            console.log("Alt: "+f2_alt);
            
            if (f2_sys ==2)   { f2_alt = fn_ft_km(f2_alt); }

            console.log("Alt:"+f2_alt+"in km");
            f2_temp_alt = fn_temp_alt(f2_alt,0);                    console.log("Temp: "+f2_temp_alt);
            f2_pres_alt = fn_pres_alt(f2_alt);                      console.log("Pres: "+f2_pres_alt);
            f2_den_alt = fn_den_alt(f2_pres_alt,f2_temp_alt);       console.log("Den: "+f2_den_alt);
            
            f2_theta_alt = f2_temp_alt/288.15;                      console.log("Theta:"+f2_theta_alt);
            f2_sigma_alt = f2_den_alt/1.2250;                       console.log("Sigma:"+f2_sigma_alt);
            f2_delta_alt = f2_pres_alt / 101325;                    console.log("Delta:"+f2_delta_alt);

            f2_vt = fn_vt_from_m(f2_m_alt,f2_theta_alt);            console.log("Vt:"+f2_vt+"kt");
            f2_ve = fn_ve_from_m(f2_m_alt,f2_delta_alt);            console.log("Ve:"+f2_ve+"kt");
            f2_vc = fn_vc_from_m(f2_m_alt,f2_delta_alt);            console.log("Vc:"+f2_vc+"kt");
            

            if(!isNaN(f2_vc)){
                if (f2_sys ==1)   {
                    document.getElementById("f2_cas").value = fn_kt_kmph(f2_vc).toFixed(1);
                    document.getElementById("f2_tas").value = fn_kt_kmph(f2_vt).toFixed(1);
                    document.getElementById("f2_eas").value = fn_kt_kmph(f2_ve).toFixed(1);
                    document.getElementById("f2_alt_other_unit").innerHTML = "&emsp;" +"("+ fn_km_ft(f2_alt).toFixed(0) +"&emsp;ft)";
                    document.getElementById("f2_tas_other_unit").innerHTML = "&emsp;" + "("+f2_vt.toFixed(1) +"&emsp;kt)";
                    document.getElementById("f2_eas_other_unit").innerHTML = "&emsp;" + "("+f2_ve.toFixed(1) +"&emsp;kt)";
                    document.getElementById("f2_cas_other_unit").innerHTML = "&emsp;" + "("+f2_vc.toFixed(1) +"&emsp;kt)";
                    
                }
                else{
                    document.getElementById("f2_cas").value = f2_vc.toFixed(1);
                    document.getElementById("f2_tas").value = f2_vt.toFixed(1);
                    document.getElementById("f2_eas").value = f2_ve.toFixed(1);
                    document.getElementById("f2_alt_other_unit").innerHTML = "&emsp;" +"("+ f2_alt.toFixed(3) +"&emsp;km)";
                    document.getElementById("f2_tas_other_unit").innerHTML = "&emsp;" + "("+fn_kt_kmph(f2_vt).toFixed(1) +"&emsp;kmph)";
                    document.getElementById("f2_eas_other_unit").innerHTML = "&emsp;" + "("+fn_kt_kmph(f2_ve).toFixed(1) +"&emsp;kmph)";
                    document.getElementById("f2_cas_other_unit").innerHTML = "&emsp;" + "("+fn_kt_kmph(f2_vc).toFixed(1) +"&emsp;kmph)";
                }
            }   
        }

        function f3_ac_selector(){
            console.log("iam in ac selector");
            if (document.getElementById('f3_Ruski').checked)
            {        
                document.getElementById("f3_tas").placeholder = "kmph";
                document.getElementById("f3_altitude").placeholder = "KM";
                f3_sys =1;
                console.log("Ruski is selected");
            }
            if (document.getElementById('f3_West').checked)
            {
                document.getElementById("f3_tas").placeholder = "kt";
                document.getElementById("f3_altitude").placeholder = "ft";
                f3_sys =2;
                console.log("West is selected");
            }
        }

        function f3_calc3()
        {

            var f3_tas_var = document.getElementById("f3_tas").value; 
            console.log("TAS: "+f3_tas_var);
            var f3_alt_var = document.getElementById("f3_altitude").value; 
            console.log("Alt: "+f3_alt_var);
            
            if (f3_sys ==2)   { f3_alt_var = fn_ft_km(f3_alt_var); }

            console.log("Alt:"+f3_alt_var+"in km");
            f3_temp_alt = fn_temp_alt(f3_alt_var,0);                        console.log("Temp: "+f3_temp_alt);
            f3_pres_alt = fn_pres_alt(f3_alt_var);                          console.log("Pres: "+f3_pres_alt);
            f3_den_alt = fn_den_alt(f3_pres_alt,f3_temp_alt);               console.log("Den: "+f3_den_alt);
                
            f3_theta_alt = f3_temp_alt/288.15;                              console.log("Theta:"+f3_theta_alt);
            f3_sigma_alt = f3_den_alt/1.2250;                               console.log("Sigma:"+f3_sigma_alt);
            f3_delta_alt = f3_pres_alt / 101325;                            console.log("Delta:"+f3_delta_alt);
            
            f3_m = fn_m_from_vt(f3_tas_var, f3_theta_alt);                  console.log("M:"+f3_m);
            f3_ve = fn_ve_from_vt(f3_tas_var, f3_sigma_alt);                console.log("EAS:"+f3_ve);
            f3_vc = fn_vc_from_vt(f3_tas_var,f3_delta_alt,f3_theta_alt);    console.log("CAS:"+f3_vc);

            if(!isNaN(f3_m)){

                document.getElementById("f3_m").value = fn_kt_kmph(f3_m).toFixed(3);
                
                if (f3_sys ==1){
                    
                    document.getElementById("f3_eas").value = fn_kt_kmph(f3_ve).toFixed(1);
                    document.getElementById("f3_cas").value = fn_kt_kmph(f3_vc).toFixed(1);
                    
                    document.getElementById("f3_alt_other_unit").innerHTML = "&emsp;" +"("+  fn_km_ft(f3_alt_var).toFixed(0) +"&emsp;ft)";
                    document.getElementById("f3_tas_other_unit").innerHTML = "&emsp;" + "("+ fn_kmph_kt(f3_tas_var).toFixed(1) +"&emsp;kt)";

                    document.getElementById("f3_eas_other_unit").innerHTML = "&emsp;" + "("+ f3_ve.toFixed(1) +"&emsp;kt)";
                    document.getElementById("f3_cas_other_unit").innerHTML = "&emsp;" + "("+ f3_vc.toFixed(1) +"&emsp;kt)";
            
                }
                else{
                    document.getElementById("f3_eas").value = fn_kt_kmph(f3_ve).toFixed(1);
                    document.getElementById("f3_cas").value = fn_kt_kmph(f3_vc).toFixed(1);
                    
                    document.getElementById("f3_alt_other_unit").innerHTML = "&emsp;" +"("+  f3_alt_var.toFixed(3) +"&emsp;km)";
                    document.getElementById("f3_tas_other_unit").innerHTML = "&emsp;" + "("+ fn_kt_kmph(f3_tas_var).toFixed(1) +"&emsp;kmph)";

                    document.getElementById("f3_eas_other_unit").innerHTML = "&emsp;" + "("+ fn_kt_kmph(f3_ve).toFixed(1) +"&emsp;kmph)";
                    document.getElementById("f3_cas_other_unit").innerHTML = "&emsp;" + "("+ fn_kt_kmph(f3_vc).toFixed(1) +"&emsp;kmph)";
                }
            }
            
        
        }

        function f4_ac_selector(){
            console.log("iam in ac selector");
            if (document.getElementById('f4_Ruski').checked)
            {        
                document.getElementById("f4_cas").placeholder = "kmph";
                f4_sys =1;
                console.log("Ruski is selected");
            }
            if (document.getElementById('f4_West').checked)
            {
                document.getElementById("f4_cas").placeholder = "kt";
                f4_sys =2;
                console.log("West is selected");
            }
        }

        function f4_calc4()
        {

            var f4_cas_var = document.getElementById("f4_cas").value; 
            var f4_m_var = document.getElementById("f4_m").value; 
            
            if (f4_sys ==2)   { f4_cas_var = fn_kt_kmph(f4_cas_var); }

            var m_temp =0;
            var alt_temp = 0; 
            var delta_m = f4_m_var-m_temp;

            while( delta_m > 0.0001)
            {
                console.log("Cur_Alt:"+alt_temp);

                f4_temp_alt = fn_temp_alt(alt_temp,0);                      //console.log("Temp: "+f4_temp_alt);
                f4_pres_alt = fn_pres_alt(alt_temp);                        //console.log("Pres: "+f4_pres_alt);
                f4_delta_alt = f4_pres_alt / 101325;                        //console.log("Delta:"+f4_delta_alt);

                m_temp = fn_m_from_cas(f4_cas_var,f4_delta_alt);            //console.log();
                delta_m = f4_m_var - m_temp;                                //console.log("Cur_M:"+m_temp+", &emsp; Delta_M:"+delta_m);
                
                alt_temp = alt_temp+0.01;
            }
            
            f4_co_alt = alt_temp - 0.01;

            console.log("Limit CAS: "+f4_cas_var);
            console.log("Limit M: "+f4_m_var);
            console.log("Change Over Altitude: "+f4_co_alt*1000+"m");

            if(f4_co_alt > 0) {

                if (f4_sys ==1){
                    document.getElementById("f4_alt").value = f4_co_alt.toFixed(2);
                    document.getElementById("f4_alt_other_unit").innerHTML = "&emsp;" +"("+  fn_km_ft(f4_co_alt).toFixed(0) +"&emsp;ft)";
                }
                else{
                    document.getElementById("f4_alt").value = fn_km_ft(f4_co_alt).toFixed(2);
                    document.getElementById("f4_alt_other_unit").innerHTML = "&emsp;" +"("+f4_co_alt.toFixed(3) +"&emsp;km)";
                }

            }
            document.getElementById("f4_status_1").innerHTML = "Altitude at which Aerodynamic Limit of aircraft";
            document.getElementById("f4_status_2").innerHTML = "or a store changes from CAS limit to Mach Limit"
        }

        function fn_m_from_cas(cas,delta){
            cas = fn_kmph_kt(cas);
            v1 = Math.pow((cas/661.4786),2)*0.2+1;
            v2 = Math.pow(v1,3.5)-1;
            v3 = v2/delta+1;
            v4 = Math.pow(v3,(1/3.5))-1;
            v5 = Math.sqrt(v4*5);
            return v5;
        }

        function fn_temp_alt(ht,temp_del) 
            { 
                if(ht <= 11)
                    { return 273.15+ +15 + -ht*6.5 + +temp_del; }
                else if( ht > 11 & ht < 20)
                    { return 216.65 +temp_del; }
                else  
                    { return 216.65 + (ht -20); }
        }

        function fn_pres_alt(ht)
        {
            if (ht <= 11)
                {
                    var c1 = 9.80665 * 28.9644 / (8.31432 *6.5);
                    //console.log(c1);
                    var v1 = 6.5 * ht /288.15;
                    //console.log(v1);
                    var p = 101325 * Math.pow((1- v1),c1);
                    //console.log(p);
                    return p;
                }
            else if ( ht>11 & ht < 20)
                {
                    return 226.3 * Math.exp(-157.696* 10**-6 * (ht*1000-11000))
                }
        }

        function fn_den_alt(pres, temp) 
            { 
                //return pres * 28.9644 / (8.31432 * temp * 1000); 
                return 1.225* pres/101325 * 288.15/temp;
        }

        function fn_ve_from_vc(vc,p){
            vc = vc *0.539957;
            delta = p/101325;                           //console.log("Delta:"+delta);
            v1 = 0.2 * Math.pow((vc/661.4786),2);       //console.log("v1:"+v1);
            v2= Math.pow((1+v1),3.5)-1;                 //console.log("v2:"+v2);
            v3 = v2/delta+1;                            //console.log("v3:"+v3);
            v4 = Math.pow(v3,(1/3.5))-1;                //console.log("v4:"+v4);
            v5 = 1479.1 * Math.sqrt(delta*v4);          //console.log("Fn_EAS:"+v5);
            return v5/0.539957;       
        }

        function fn_vt_from_m(m,theta){
            return 661.4786 * m * Math.sqrt(theta);
        }

        function fn_ve_from_m(m, delta){
            return 661.4786*m*Math.sqrt(delta);
        }

        function fn_vc_from_m(m,delta){

            v1= 0.2 * m * m + 1;                        //console.log("v1:"+v1);
            v2 = Math.pow(v1,3.5)-1;                    //console.log("v2:"+v2);
            v3 = v2* delta+1;                           //console.log("v3:"+v3);
            v4 = Math.pow(v3,(1/3.5))-1;                //console.log("v4:"+v4);
            v5 = 1479.1 * Math.sqrt(v4);                //console.log("VC:"+v5);
            return v5;
        }

        function fn_m_from_vt(vt,theta){
            vt = fn_kmph_kt(vt);
            return vt / (661.4786 * Math.sqrt(theta));
        }

        function fn_ve_from_vt(vt,sigma){
            vt = fn_kmph_kt(vt);
            return vt*Math.sqrt(sigma);
        }

        function fn_vc_from_vt(tas,delta,theta){

            tas = fn_kmph_kt(tas);
            v1 = Math.pow((tas/1479.1),2)/theta;
            v2 = Math.pow((1+v1),3.5)-1;
            v3 = delta * v2 +1;
            v4 = Math.pow(v3,(1/3.5))-1;
            v5 = 1479.1 * Math.sqrt(v4);    console.log(v5);          
            return v5;            
        }

        function fn_ft_km(ft) { return ft*0.0003048 }
        function fn_km_ft(km) { return km*3280.84}

        function fn_kt_kmph(kt) { return kt*1.852 }
        function fn_kmph_kt(kmph) {return kmph*0.539957}

        function fn_sos_temp(temp_alt){ return Math.sqrt(1.4*8314.3/28.97*temp_alt)}
        function fn_metpersec_kmph(mps){ return mps* 3.6}
    
    </script>
    <!--<script src=test_v4.js></script> -->
</html>
